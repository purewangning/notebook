# React 生命周期

## 一、什么是生命周期

### <p><p>

> + 组件从创建到死亡它都会经历一些特定的阶段
> + React组件中包含一系列勾子函数（生命周期回调函数），它会在特定的时刻调用。
> + 我们在定义组件时，会在特定的生命周期回调函数中，做特定的工作。

### <p><p>

## 二、生命周期流程图（旧）

### <p><p>

![alt 属性文本](./react生命周期(旧).png)

### <p><p>

### 生命周期的三个阶段（旧）
> 1.初始化阶段：由ReactDOM.render()触发 —— 初次渲染
> > + constructor() —— 初始化
> > + componentWillMount() —— 组件将要挂载时
> > + render() —— 组件挂载函数
> > + componentDidMount() —— 组件挂载完后，一般在这个钩子函数上做一些初始化的事情。
> 
> 2.更新阶段：由组件内部this.setState()或父组件render触发
> > + shouldComponentUpdate() —— 控制组件更新的“阀门”，如果重写该函数，则需要具有返回值（true或false）
> > + componentWillUpdate() —— 组件将要更新的钩子函数
> > + render() ——  组件挂载函数
> > + componentDidUpdate() ——  组件更新完毕的钩子函数
> 
> 3.卸载组件：由ReactDOM.unmountComponentAtNode()触发
> > + componentWillUnmount() —— 组件卸载完毕的钩子函数
> 
> 4.父组件重新render阶段
> > + componentWillReceiveProps() —— 第一次更新时不会被调用，再一次更新后会被调用。



### <p><p>

## 三、生命周期流程图（新）

![alt 属性文本](./react生命周期(新).png)

### <p><p>

#### &nbsp;&nbsp; 17.0版本后的react废弃了三个生命周期方法（componentWillMount,componentWillUpdate,componentWillReceiveProps），添加了两个新的生命周期方法（getDerivedStateFromProps,getDerivedStateFromProps）

### <p><p>

### 生命周期的三个阶段（新）
> 1.初始化阶段：由ReactDOM.render()触发 —— 初次渲染
> > + constructor() —— 初始化
> > + getDerivedStateFromProps() —— 在初始化挂载及后续更新时会被调用。它需要返回一个对象来更新state，如果返回Null则不更新任何内容。（即state的值在任何时候都取决于props的时候调用该方法）
> > + render() ——  组件挂载函数
> > + componentDidMount() —— 组件挂载完后，一般在这个钩子函数上做一些初始化的事情。
> 
> 2.更新阶段：由组件内部 this.setState() 或 父组件重写 render 触发
> > + getDerivedStateFromProps() 
> > + shouldComponentUpdate() —— 控制组件更新的“阀门”，如果重写该函数，则需要具有返回值（true或false）
> > + render() 
> > + getSnapshotBeforeUpdate() —— 组件更新状态前的快照，在最近一次渲染节点之前调用。它使得组件能在发生更改之前从DOM中捕获一些信息（旧参数）。此生命周期方法的任何返回值将作为参数传递给componentDidUpdate()。可接受两个参数（props，state）
> > + componentDidUpdate() —— 组件更新完毕的钩子函数。
> 
> 3.卸载组件：由 ReactDOM.unmountComponentAtNode()触发
> > + componentWillUnmount() —— 组件卸载完毕的钩子函数
